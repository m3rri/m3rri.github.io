<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><script>
                        window.dataLayer = window.dataLayer || [];
                        function gtag(){dataLayer.push(arguments);}
                        gtag('js', new Date());
                        gtag('config', 'G-GMHYS5H2BM', {
                        page_path: window.location.pathname,
                        });
                        </script><meta name="google-site-verification" content="-IYFAYTqi7mYYCPb6BhJKCcZVcWghBEgTqFyxyXrNBc"/><meta name="naver-site-verification" content="869be3cd7f5f9946dbdd42922f42f54838b579c5"/><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/703309190fe4a24f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/703309190fe4a24f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-3b9f585595485920.js" defer=""></script><script src="/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/_next/static/chunks/main-acf70204e036151b.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9a4472e15ed266b4.js" defer=""></script><script src="/_next/static/chunks/838-07ce0bc3d5f0a553.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5BpostId%5D-e6be2160b79de1f8.js" defer=""></script><script src="/_next/static/PHLxsgcNLF0x70eC5EpSo/_buildManifest.js" defer=""></script><script src="/_next/static/PHLxsgcNLF0x70eC5EpSo/_ssgManifest.js" defer=""></script><script src="/_next/static/PHLxsgcNLF0x70eC5EpSo/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><style data-emotion="css tlc243">.css-tlc243{color:#333;}</style><div class="css-tlc243"><style data-emotion="css nmrzmf">.css-nmrzmf{border-bottom:1px solid #0C8346;}.css-nmrzmf.header-get-on{z-index:10;position:fixed;top:0;width:100%;}</style><header class=" css-nmrzmf"><style data-emotion="css 10w003c">.css-10w003c{padding:7px 8px;background:#fff;}.css-10w003c .navbar-container{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-left:auto;margin-right:auto;width:100%;}</style><nav role="navigation" aria-label="Main navigation" class="css-10w003c"><div class="navbar-container"><style data-emotion="css 1c84t5t">.css-1c84t5t{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-style:italic;font-size:20px;color:#333;font-weight:bold;white-space:nowrap;-webkit-text-decoration:none;text-decoration:none;}.css-1c84t5t:hover{font-style:normal;}</style><a href="/" class="css-1c84t5t">MERRI`s DEVELOG</a><style data-emotion="css n51kqw">.css-n51kqw{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-left:12px;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;padding:0 4px;background:transparent;border:0;cursor:pointer;font-size:13px;line-height:18px;}@media(min-width: 768px){.css-n51kqw{display:none;}}</style><button type="button" aria-expanded="false" aria-controls="navbar-menu" aria-label="Toggle navigation menu" class="css-n51kqw"><span class="sr-only">Open blog menu</span>📚</button><style data-emotion="css 132tmbc">.css-132tmbc{width:100%;margin-bottom:-6px;display:none;}@media(min-width: 768px){.css-132tmbc{border:0;display:block;width:auto;margin-bottom:0;}}</style><div id="navbar-menu" role="navigation" aria-label="Main navigation" class="css-132tmbc"><style data-emotion="css 10t3hx5">.css-10t3hx5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;font-size:14px;margin:16px -8px 0 -8px;list-style:none;padding:0;}.css-10t3hx5 .navbar-menu:not(:first-of-type){border-top:1px solid #0C8346;}@media(min-width: 768px){.css-10t3hx5{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin:0;font-size:14px;line-height:20px;}.css-10t3hx5 .navbar-menu:not(:first-of-type){border-top:0;border-left:1px solid #0C8346;}}</style><ul class="navbar-menu-list css-10t3hx5"><style data-emotion="css e7ia66">.css-e7ia66:hover{background:#8FD5A6;transition-duration:500ms;}.css-e7ia66:hover .navbar-menu-link,.css-e7ia66:hover .navbar-menu a{color:#333;}</style><style data-emotion="css 19x6ejr">@media(min-width: 768px){.css-19x6ejr{padding:10px 20px 7px;margin:-10px 0 -10px -1px;}.css-19x6ejr.active-link-home{padding-bottom:12px;}}.css-19x6ejr:hover{background:#8FD5A6;transition-duration:500ms;}.css-19x6ejr:hover .navbar-menu-link,.css-19x6ejr:hover .navbar-menu a{color:#333;}</style><li class="navbar-menu active-link-home css-19x6ejr"><style data-emotion="css mnwgy4">.css-mnwgy4{border-bottom:6px solid #E5C2C0;}</style><style data-emotion="css 4xdf42">.css-4xdf42{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;padding:9px 16px 9px 12px;width:100%;border-bottom:6px solid #E5C2C0;}.css-4xdf42:hover{border:1 solid #8FD5A6;color:#333;transition-duration:500ms;}@media(min-width: 768px){.css-4xdf42{padding:16px 12px 7px;margin:-14px -20px -7px;width:auto;}}</style><button data-dropdown-for="dropdown_Blog" class="css-4xdf42">Blog<!-- --> 📔</button><style data-emotion="css ewer5w">.css-ewer5w{display:none;}</style><style data-emotion="css j3irkc">.css-j3irkc{background:#fff;border:1px solid #0C8346;margin:8px 20px;position:relative;width:auto;z-index:0;display:none;}@media(min-width: 768px){.css-j3irkc{margin:6px;position:absolute;z-index:10;}}.css-j3irkc .dropdown-menu-list{font-size:14px;padding:4px 0;}.css-j3irkc .dropdown-menu-list .dropdown-menu-list-part-name{color:#333;font-size:12px;font-weight:bold;padding-left:8px;}.css-j3irkc .dropdown-menu-list li{border:0;}.css-j3irkc .dropdown-menu-list a{display:block;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:8px 16px;}.css-j3irkc .dropdown-menu-list a:hover{background:#8FD5A6;color:#fff;transition-duration:300ms;}.css-j3irkc .dropdown-menu-list .dropdown-menu-active-link{background:#E5C2C0;}.css-j3irkc ul:not(:first-of-type){border-top:1px solid #8FD5A6;}</style><div id="dropdown_Blog" class="css-j3irkc"><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">BACKEND</span><li><a class="" href="/blog/category/spring">Spring</a></li><li><a class="" href="/blog/category/java">Java</a></li></ul><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">SW</span><li><a class="" href="/blog/category/security">Security</a></li><li><a class="" href="/blog/category/design%20pattern">Design pattern</a></li></ul><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">INFRA</span><li><a class="" href="/blog/category/kubernetes">Kubernetes</a></li><li><a class="" href="/blog/category/network">Network</a></li></ul><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">CLOUD</span><li><a class="" href="/blog/category/aws">Aws</a></li></ul><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">OS</span><li><a class="" href="/blog/category/window">Window</a></li><li><a class="" href="/blog/category/linux">Linux</a></li></ul><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">FRONTEND</span><li><a class="" href="/blog/category/javascript">Javascript</a></li></ul><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">TOOL</span><li><a class="" href="/blog/category/git">Git</a></li></ul><ul class="dropdown-menu-list"><span class="dropdown-menu-list-part-name">IDEA</span><li><a class="" href="/blog/category/intellij">Intellij</a></li></ul></div></li><li class="navbar-menu  css-19x6ejr"><style data-emotion="css 2cfnz">.css-2cfnz{cursor:pointer;display:block;padding:8px 16px 8px 12px;-webkit-text-decoration:none;text-decoration:none;color:inherit;}@media(min-width: 768px){.css-2cfnz{padding-bottom:7px;padding-top:7px;padding-right:12px;margin:-7px -20px;}}.css-2cfnz.navbar-menu-active-link{border-bottom:6px solid transparent;border-image:linear-gradient(to right, #E5C2C0 25%, #fff 25%) 1 100%;border-image-slice:1;}@media(min-width: 768px){.css-2cfnz.navbar-menu-active-link{border-image:linear-gradient(to right, #E5C2C0 100%, #fff) 1 100%;border-image-slice:1;}}</style><a class="navbar-menu-link  css-2cfnz" href="/portfolio">Portfolio<!-- --> 📄</a></li><li class="navbar-menu  css-19x6ejr"><a class="navbar-menu-link  css-2cfnz" href="/about">About<!-- --> 📄</a></li></ul></div></div></nav></header><style data-emotion="css 1ho3vgx">.css-1ho3vgx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}.css-1ho3vgx .main-area{-webkit-flex:none;-ms-flex:none;flex:none;margin:16px 0;width:100%;}@media(min-width: 1024px){.css-1ho3vgx .main-area{width:1000px;margin:16px 12px;}}</style><div class="css-1ho3vgx"><style data-emotion="css 1hten03">.css-1hten03{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;height:100%;width:8px;}</style><div class="css-1hten03"></div><main class="main-area"><style data-emotion="css 2pdmeq">.css-2pdmeq{border:0;margin:-16px 0;}@media(min-width: 1024px){.css-2pdmeq{border-left:1px solid #0C8346;border-right:1px solid #0C8346;margin-left:0;margin-right:0;}}.css-2pdmeq .markdown-body{padding:12px 20px;}@media(min-width: 1024px){.css-2pdmeq .markdown-body{padding-left:16px;padding-right:16px;}}.css-2pdmeq .markdown-body>pre{padding:0;background:none!important;}.css-2pdmeq .markdown-body pre:has(pre){padding:0;background:none;}.css-2pdmeq .markdown-body img{display:block;margin:1rem auto;}.css-2pdmeq .end-of-post{color:#329F5B;padding:8px 8px0 8px;}@media(min-width: 1024px){.css-2pdmeq .end-of-post{padding-left:0;padding-right:0;}}</style><div class="css-2pdmeq"><style data-emotion="css ao9izc">.css-ao9izc{border-bottom:1px solid #0C8346;padding:8px;}.css-ao9izc h1{color:#333;padding-bottom:4px;}.css-ao9izc div{color:#aaa;font-size:14px;}</style><header class="css-ao9izc"><h1>JPA 상속관계 매핑 전략</h1><div>2022-10-28</div></header><style data-emotion="css r0tt3h">.css-r0tt3h{padding:8px;}.css-r0tt3h div{font-size:14px;}.css-r0tt3h a:hover{color:#8FD5A6;}</style><div class="css-r0tt3h"><div>📂 <span><a href="/blog/category/backend">backend</a></span><span><span> &gt; </span><a href="/blog/category/spring">spring</a></span></div><div>🧶<span><span> </span><a href="/blog/tag/jpa">#<!-- -->jpa</a></span><span><span> </span><a href="/blog/tag/@inheritance">#<!-- -->@inheritance</a></span><span><span> </span><a href="/blog/tag/@mappedsuperclass">#<!-- -->@MappedSuperclass</a></span></div></div><main class="markdown-body"><h2>JPA Entity 상속 관계 매핑 전략</h2>
<p><strong>🌟 출처 : <a href="https://ict-nroo.tistory.com/128">개발자의 기록습관 - [JPA] 상속관계 매핑 전략(@Inheritance, @DiscriminatorColumn)</a></strong></p>
<h3>공부하게 된 배경</h3>
<blockquote>
<ol>
<li>Spring 프로젝트에 <code>JPA Entity</code>에 생성, 수정 시간 관리를 위한 칼럼이 존재.</li>
<li>국제화를 위해 <code>UTC</code>를 기준으로 삼아 BE에서 처리하고 클라이언트에서 시간을 요청 시 FE에서 지역화하기 위해 <code>@PrePersist</code>, <code>@PreUpdate</code> 어노테이션이 적용된 메소드를 사용.</li>
<li>프로젝트에서 관리하는 Entity가 확대될 경우에도 기준 시간을 UTC로 일정하게 가져가기 위해서 위 메소드를 상속받도록 BaseEntity를 설계</li>
<li>그냥 상속하니까 <code>@Table</code> 어노테이션에 설정한 테이블이 아니라 <code>baseEntity</code>라는 이름의 테이블이 새로 생기면서 <code>DTYPE</code>이라는 칼럼에 원래 테이블 entity명이 입력 됨</li>
</ol>
</blockquote>
<h3>DB의 <code>super type</code> :arrow_right: <code>sub type</code>를 물리 모델로 구현하는 3가지 방법</h3>
<ul>
<li><strong>Enttiy Diagram</strong><br/>
<img src="https://user-images.githubusercontent.com/94826141/197458035-7ef7dd46-e3c9-4a9b-aea0-a0d096252da2.png" alt="diagram"/></li>
<li><strong>Entity.class</strong>
<pre><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-java" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">1</span><span class="token annotation" style="color:#999">@Entity</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">2</span><span></span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token" style="color:#DD4A68">BaseEntity</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">3</span><span>    </span><span class="token annotation" style="color:#999">@Id</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">4</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;tuple_id&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">5</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">String</span><span> tupleId</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">6</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;create_time&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">7</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">Timestamp</span><span> createTime</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">8</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;update_time&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">9</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">Timestamp</span><span> updateTime</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">10</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">11</span><span>    </span><span class="token annotation" style="color:#999">@PrePersist</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">12</span><span>    </span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#07a">void</span><span> </span><span class="token" style="color:#DD4A68">beforeAdd</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">13</span><span>        </span><span class="token" style="color:#DD4A68">LocalDateTime</span><span> ldt </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">LocalDateTime</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">ofInstant</span><span class="token" style="color:#999">(</span><span class="token" style="color:#DD4A68">Instant</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">now</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#DD4A68">ZoneOffset</span><span class="token" style="color:#999">.</span><span>UTC</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">14</span><span>        </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span>createTime </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">Timestamp</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">valueOf</span><span class="token" style="color:#999">(</span><span>ldt</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">15</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">16</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">17</span><span>    </span><span class="token annotation" style="color:#999">@PreUpdate</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">18</span><span>    </span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#07a">void</span><span> </span><span class="token" style="color:#DD4A68">beforeUpdate</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">19</span><span>        </span><span class="token" style="color:#DD4A68">LocalDateTime</span><span> ldt </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">LocalDateTime</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">ofInstant</span><span class="token" style="color:#999">(</span><span class="token" style="color:#DD4A68">Instant</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">now</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#DD4A68">ZoneOffset</span><span class="token" style="color:#999">.</span><span>UTC</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">20</span><span>        </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span>updateTime </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">Timestamp</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">valueOf</span><span class="token" style="color:#999">(</span><span>ldt</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">21</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">22</span><span></span><span class="token" style="color:#999">}</span></code></pre></pre>
</li>
</ul>
<ol>
<li><code>JOINED</code> : 각각의 테이블로 생성한 뒤 조인하는 전략</li>
</ol>
<ul>
<li>implement code<!-- -->
<pre><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-java" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">1</span><span class="token annotation" style="color:#999">@Entity</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">2</span><span></span><span class="token annotation" style="color:#999">@Inheritance</span><span class="token" style="color:#999">(</span><span>strategy </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">InheritanceType</span><span class="token" style="color:#999">.</span><span>JOINED</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">3</span><span></span><span class="token annotation" style="color:#999">@DiscriminatorColumn</span><span class="token" style="color:#999">(</span><span>name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#690">&quot;DTYPE&quot;</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:slategray">//default가 DTYPE</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">4</span><span></span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token" style="color:#DD4A68">BaseEntity</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">5</span><span>    </span><span class="token annotation" style="color:#999">@Id</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">6</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;tuple_id&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">7</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">String</span><span> tupleId</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">8</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;create_time&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">9</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">Timestamp</span><span> createTime</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">10</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;update_time&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">11</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">Timestamp</span><span> updateTime</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">13</span><span>    </span><span class="token annotation" style="color:#999">@PrePersist</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">14</span><span>    </span><span class="token" style="color:#999">.</span><span class="token" style="color:#999">.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">15</span><span></span><span class="token" style="color:#999">}</span></code></pre></pre>
</li>
<li><code>base_item</code>, <code>app_a</code>, <code>app_b</code>, <code>app_c</code> 4개의 테이블이 관리되며 base_item 테이블에만 tuple_id, create_time, update_time 의 데이터가 저장된다. tuple_id 칼럼이 PK이자 FK가 된다.</li>
<li>필수로 선언해야 하는 <code>@DiscriminatorColumn</code>으로 생성된 <code>DTYPE</code> 칼럼은 <code>sub type</code> 테이블 중 어떤 곳에 데이터가 생성되었는지 명시하는 역할이며, default는 엔티티 클래스 이름이 사용된다 (<code>appA</code>, <code>appB</code>, <code>appC</code>)</li>
<li><code>app_a</code> 테이블에 신규 데이터를 저장하면 insert query가 두 번 실행되며, <code>app_a</code> 데이터를 생성 시간과 함께 조회하고자 하면 조인이 필요해진다.</li>
<li>DB 관점에서 가장 정규화된 구조이며 메모리 측면에서도 잇점이 있다고 한다.</li>
</ul>
<ol start="2">
<li><code>SINGLE_TABLE</code> : 통합 테이블로 변환하는 단일 테이블 전략</li>
</ol>
<ul>
<li>implement code<!-- -->
<pre><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-java" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">1</span><span class="token annotation" style="color:#999">@Entity</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">2</span><span></span><span class="token annotation" style="color:#999">@Inheritance</span><span class="token" style="color:#999">(</span><span>strategy </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">InheritanceType</span><span class="token" style="color:#999">.</span><span>SINGLE_TABLE</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">3</span><span></span><span class="token" style="color:slategray">//@DiscriminatorColumn default DTYPE으로 칼럼 생성해줌</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">4</span><span></span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token" style="color:#DD4A68">BaseEntity</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">5</span><span>    </span><span class="token annotation" style="color:#999">@Id</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">6</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;tuple_id&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">7</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">String</span><span> tupleId</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">8</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;create_time&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">9</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">Timestamp</span><span> createTime</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">10</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;update_time&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">11</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">Timestamp</span><span> updateTime</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">13</span><span>    </span><span class="token annotation" style="color:#999">@PrePersist</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">14</span><span>    </span><span class="token" style="color:#999">.</span><span class="token" style="color:#999">.</span><span class="token" style="color:#999">.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">15</span><span></span><span class="token" style="color:#999">}</span></code></pre></pre>
</li>
<li>규모나 복잡도가 크지 않은 엔티티들의 경우 모든 엔티티의 칼럼을 한 테이블에 다 저장하고 <code>DTYPE</code>으로 구분할 수 있다.</li>
<li>insert query도 한 번이고, 조인도 필요가 없다.</li>
<li>진행 중인 프로젝트에서는 appA~appC 에 대한 칼럼 변경이 빈번하게 일어나며 DB를 웹에서만 접근하는 구조가 아니기 때문에 한 테이블에 몰아두고 <code>DTYPE</code>으로 구분하여 사용하기에는 무리가 있다.</li>
</ul>
<ol start="3">
<li><strong><code>TABLE_PER_CLASS</code> : 구현 클래스마다 테이블을 생성하는 전략</strong></li>
</ol>
<ul>
<li>implement code<!-- -->
<pre><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-java" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">1</span><span class="token annotation" style="color:#999">@Entity</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">2</span><span></span><span class="token annotation" style="color:#999">@Inheritance</span><span class="token" style="color:#999">(</span><span>strategy </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">InheritanceType</span><span class="token" style="color:#999">.</span><span>TABLE_PER_CLASS</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">3</span><span></span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token" style="color:#DD4A68">BaseEntity</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">4</span><span>    </span><span class="token annotation" style="color:#999">@Id</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">5</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;tuple_id&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">6</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">String</span><span> tupleId</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">7</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;create_time&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">8</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">Timestamp</span><span> createTime</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">9</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;update_time&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">10</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">Timestamp</span><span> updateTime</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">11</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">12</span><span>    </span><span class="token annotation" style="color:#999">@PrePersist</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">13</span><span>    </span><span class="token" style="color:#999">.</span><span class="token" style="color:#999">.</span><span class="token" style="color:#999">.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">14</span><span></span><span class="token" style="color:#999">}</span></code></pre></pre>
</li>
<li>1번 JOINED 전략과 유사해보이지만 <code>super type</code> 엔티티의 칼럼들을 <code>sub type</code>의 엔티티 모두에 동일하게 생성하여 <code>app_a</code>, <code>app_b</code>, <code>app_c</code> 총 3개의 테이블을 관리하게 된다.</li>
<li><code>super type</code> 엔티티로 접근할 경우 <code>app_a</code>~<code>app_c</code> 를 <code>UNION</code> 연산자를 사용하여 조회하기 때문에 이런 경우 성능이 좋다고 할 수는 없다.</li>
</ul>
<hr/>
<h2>어노테이션 등 설정값 정리</h2>
<p><strong>🌟 출처 : <a href="https://victorydntmd.tistory.com/209">victolee - [Spring JPA] 상속(JOINED 전략을 중심으로)</a></strong></p>
<h3>상속 관계 관련</h3>
<ul>
<li>@Inheritance<!-- -->
<ul>
<li>어떤 상속 전략을 사용할 것인지 명시</li>
</ul>
</li>
<li>@DiscriminatorColumn<!-- -->
<ul>
<li><code>super type</code> 엔티티에서 어떤 칼럼을 사용하여 <code>sub type</code> 엔티티를 구분할 것인지 명시</li>
</ul>
</li>
<li>@DiscriminatorValue<!-- -->
<ul>
<li>위의 칼럼에서 <code>sub type</code> 엔티티 별로 값을 가지도록 지정</li>
<li>DB에서 table column value로 들어갈 값이기 때문에 영어/한글 구분 없이 사용 가능</li>
</ul>
</li>
</ul>
<h3>객체 매핑 관련</h3>
<ul>
<li>@MappedSuperclass<!-- -->
<ul>
<li>객체 지향적으로는 상속 관계를 유지하지만 실제 구현될 entity에는 영향을 주지 않기 위해서 사용</li>
<li><code>super type</code> 엔티티에서 <code>@Entity</code> 대신 <code>@MappedSuperclass</code>로 선언<!-- -->
<ul>
<li>실제로 구현 될 엔티티가 아니기 때문에 추상클래스로 선언</li>
<li><code>@ID</code> 로 선언해서 사용할 id 칼럼도 필요없음</li>
</ul>
</li>
<li>위의 예제에서 <code>BaseEntity</code>에 이 어노테이션을 적용하면 <code>BaseEntity</code>에 대한 엔티티는 생성되지 않고, <code>TABLE_PER_CLASS</code> 전략을 적용한 것과 유사하게 <code>BaseEntity</code>에 있는 칼럼을 모두 자식 <code>sub type</code> 엔티티에 포함하여 생성</li>
</ul>
</li>
<li>@AttributeOverride / @AttributeOverrides<!-- -->
<ul>
<li><code>@MappedSuperclass</code>를 사용하는 경우, 부모 클래스의 특정 칼럼을 override하려고 할 때 사용</li>
</ul>
<pre><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-java" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">1</span><span class="token annotation" style="color:#999">@MappedSuperclass</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">2</span><span></span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#07a">abstract</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token" style="color:#DD4A68">BaseEntity</span><span class="token" style="color:#999">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">3</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;create_time&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">4</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">Timestamp</span><span> createTime</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">5</span><span>    </span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;update_time&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">6</span><span>    </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">Timestamp</span><span> updateTime</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">7</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">8</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">9</span><span></span><span class="token annotation" style="color:#999">@Entity</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">10</span><span></span><span class="token annotation" style="color:#999">@AttributeOverride</span><span class="token" style="color:#999">(</span><span>name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#690">&quot;updateTime&quot;</span><span class="token" style="color:#999">,</span><span> column</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#690">&quot;app_a_update_time&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">11</span><span></span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token" style="color:#DD4A68">AppA</span><span> </span><span class="token" style="color:#07a">extends</span><span> </span><span class="token" style="color:#DD4A68">BaseEntity</span><span class="token" style="color:#999">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">12</span><span>  </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">String</span><span> appAVar</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">13</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">14</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">15</span><span></span><span class="token annotation" style="color:#999">@Entity</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">16</span><span></span><span class="token annotation" style="color:#999">@AttributeOverrides</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">17</span><span>  </span><span class="token annotation" style="color:#999">@AttributeOverride</span><span class="token" style="color:#999">(</span><span>name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#690">&quot;createTime&quot;</span><span class="token" style="color:#999">,</span><span> column</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#690">&quot;app_b_create_time&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">18</span><span>  </span><span class="token annotation" style="color:#999">@AttributeOverride</span><span class="token" style="color:#999">(</span><span>name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#690">&quot;updateTime&quot;</span><span class="token" style="color:#999">,</span><span> column</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token annotation" style="color:#999">@Column</span><span class="token" style="color:#999">(</span><span>name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#690">&quot;app_b_update_time&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">19</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">20</span><span></span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token" style="color:#DD4A68">AppB</span><span> </span><span class="token" style="color:#07a">extends</span><span> </span><span class="token" style="color:#DD4A68">BaseEntity</span><span class="token" style="color:#999">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">21</span><span>  </span><span class="token" style="color:#07a">private</span><span> </span><span class="token" style="color:#DD4A68">String</span><span> appBVar</span><span class="token" style="color:#999">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:slategray">22</span><span></span><span class="token" style="color:#999">}</span></code></pre></pre>
</li>
</ul>
<hr/>
<h3>결론</h3>
<ul>
<li>원래 적용하려고 했던 내용은 <code>@MappedSuperclass</code>를 사용하여 적용하였음</li>
<li>기존에 QueryDsl로 직접 조인하여 select 하도록 설계했던 부분을 JAVA code 상에서 명시적으로 상속 관계에 있음을 파악할 수 있도록 관련있는 엔티티들에 JOINED 전략을 적용하였음</li>
</ul>
<h3>참조</h3>
<ul>
<li>Entity에서는 여러 변수에 @Id를 선언하여 복합키로써 사용할 수 있는데, 이 경우 @GeneratedValue를 사용할 수가 없다. 직접 할당만 가능<br/>
<!-- -->(출처 : <a href="https://www.icatpark.com/entry/jpa-%EB%B3%B5%ED%95%A9%ED%82%A4%EC%97%90%EC%84%9C-auto-increment">catpark&#x27;s something new - jpa 복합키에서 auto increment</a>)</li>
</ul></main><div class="end-of-post">/end of <!-- -->JPA 상속관계 매핑 전략</div><style data-emotion="css 1v142rx">.css-1v142rx{border-top:1px solid #0C8346;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:8px;}@media(min-width: 768px){.css-1v142rx{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}.css-1v142rx div:first-of-type{-webkit-flex:1 1 0%;-ms-flex:1 1 0%;flex:1 1 0%;}.css-1v142rx div:last-of-type{text-align:right;}</style><footer class="css-1v142rx"><div><style data-emotion="css 173eilp">.css-173eilp{cursor:pointer;padding-left:4px;}.css-173eilp:hover{color:#aaa;}</style><a class="css-173eilp"><style data-emotion="css d5okxo">.css-d5okxo{font-size:0.85rem;}</style><span class="css-d5okxo">(이전글)</span>Ubuntu 명령어 정리</a></div><div><a class="css-173eilp">Ubuntu 명령어 정리(2)<span class="css-d5okxo">(다음글)</span></a></div></footer><div style="border-top:1px solid #0C8346;padding:8px"><div style="display:flex;justify-content:space-between"><span style="font-weight:bold">CONTENT LIST</span><span style="color:#8FD5A6;font-weight:bold">MERRI＇s DEVELOG</span></div><div><style data-emotion="css 1ax1d4x">.css-1ax1d4x{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;padding:12px 8px;}.css-1ax1d4x:not(:first-of-type){margin:6px 0 0;border-top:1px solid #efefef;}</style><div class="css-1ax1d4x"><style data-emotion="css 17jq971">.css-17jq971{algin-self:center;-webkit-flex:1 1 0%;-ms-flex:1 1 0%;flex:1 1 0%;}.css-17jq971 a div{color:#333;font-weight:500;}.css-17jq971 a div:hover{color:#aaa;}</style><div class="css-17jq971"><a href="/blog/20230209"><div>[js] Default parameters of function &amp; Spread syntax in object literals</div></a><style data-emotion="css 8fkig0">.css-8fkig0 a,.css-8fkig0 span{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;color:#8FD5A6;font-size:12px;padding-top:3px;}.css-8fkig0 a{cursor:pointer;}.css-8fkig0 span{cursor:default;}.css-8fkig0 a:hover{color:#E5C2C0;}</style><div class="css-8fkig0"><a href="/blog/category/javascript">javascript</a><span> |</span><span><span> </span><a href="/blog/tag/javascript">#<!-- -->javascript</a></span><span><span> </span><a href="/blog/tag/es5">#<!-- -->es5</a></span><span><span> </span><a href="/blog/tag/default%20parameter">#<!-- -->default parameter</a></span><span><span> </span><a href="/blog/tag/spread%20syntax">#<!-- -->spread syntax</a></span></div></div><style data-emotion="css 1uiyfyi">.css-1uiyfyi{color:#aaa;-webkit-flex:none;-ms-flex:none;flex:none;font-size:12px;padding-top:3px;}</style><span class="css-1uiyfyi">2023-02-09</span></div><div class="css-1ax1d4x"><div class="css-17jq971"><a href="/blog/20221114"><div>Github Action - AWS EC2에 SpringBoot 배포</div></a><div class="css-8fkig0"><a href="/blog/category/git">git</a><span> |</span><span><span> </span><a href="/blog/tag/git-action">#<!-- -->git-action</a></span><span><span> </span><a href="/blog/tag/git">#<!-- -->Git</a></span><span><span> </span><a href="/blog/tag/aws">#<!-- -->aws</a></span></div></div><span class="css-1uiyfyi">2022-11-14</span></div><div class="css-1ax1d4x"><div class="css-17jq971"><a href="/blog/20221109"><div>Ubuntu 명령어 정리(2)</div></a><div class="css-8fkig0"><a href="/blog/category/linux">linux</a><span> |</span><span><span> </span><a href="/blog/tag/command">#<!-- -->command</a></span></div></div><span class="css-1uiyfyi">2022-11-09</span></div><div class="css-1ax1d4x"><div class="css-17jq971"><a href="/blog/20221020"><div>Ubuntu 명령어 정리</div></a><div class="css-8fkig0"><a href="/blog/category/linux">linux</a><span> |</span><span><span> </span><a href="/blog/tag/command">#<!-- -->command</a></span></div></div><span class="css-1uiyfyi">2022-10-20</span></div><div class="css-1ax1d4x"><div class="css-17jq971"><a href="/blog/20220816"><div>What happens when jdk compiles the generic type &lt;T&gt;</div></a><div class="css-8fkig0"><a href="/blog/category/java">java</a><span> |</span><span><span> </span><a href="/blog/tag/generic">#<!-- -->Generic</a></span><span><span> </span><a href="/blog/tag/type%20erasure">#<!-- -->Type Erasure</a></span><span><span> </span><a href="/blog/tag/classcastexception">#<!-- -->ClassCastException</a></span></div></div><span class="css-1uiyfyi">2022-08-16</span></div></div></div></div></main><div class="css-1hten03"></div></div><style data-emotion="css 9m6uqx">.css-9m6uqx{background:#fff;border-top:1px solid #0C8346;color:#333;font-size:13px;letter-spacing:-0.01em;padding:11px;}.css-9m6uqx div:not(:first-of-type){padding:4px 0 0;}.css-9m6uqx svg{display:inline;vertical-align:middle;}.css-9m6uqx a:hover{color:#E5C2C0;}.css-9m6uqx.fixed-bottom{bottom:0;position:fixed;width:100%;}</style><footer class=" css-9m6uqx"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg> m3rri17@gmail.com</div><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><a target="_blank" href="https://github.com/m3rri"> https://github.com/m3rri</a></div><div>© 2022-<!-- -->2025<!-- --> KimHyeRi. All rights reserved.</div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"20221028","content":"\n## JPA Entity 상속 관계 매핑 전략\n**🌟 출처 : [개발자의 기록습관 - [JPA] 상속관계 매핑 전략(@Inheritance, @DiscriminatorColumn)](https://ict-nroo.tistory.com/128)**\n### 공부하게 된 배경\n\n\u003e 1. Spring 프로젝트에 `JPA Entity`에 생성, 수정 시간 관리를 위한 칼럼이 존재.\n\u003e 2. 국제화를 위해 `UTC`를 기준으로 삼아 BE에서 처리하고 클라이언트에서 시간을 요청 시 FE에서 지역화하기 위해 `@PrePersist`, `@PreUpdate` 어노테이션이 적용된 메소드를 사용.\n\u003e 3. 프로젝트에서 관리하는 Entity가 확대될 경우에도 기준 시간을 UTC로 일정하게 가져가기 위해서 위 메소드를 상속받도록 BaseEntity를 설계\n\u003e 4. 그냥 상속하니까 `@Table` 어노테이션에 설정한 테이블이 아니라 `baseEntity`라는 이름의 테이블이 새로 생기면서 `DTYPE`이라는 칼럼에 원래 테이블 entity명이 입력 됨\n\n### DB의 `super type` :arrow_right: `sub type`를 물리 모델로 구현하는 3가지 방법\n* **Enttiy Diagram**  \n![diagram](https://user-images.githubusercontent.com/94826141/197458035-7ef7dd46-e3c9-4a9b-aea0-a0d096252da2.png)\n* **Entity.class**\n  ```java\n  @Entity\n  public class BaseEntity {\n      @Id\n      @Column(name = \"tuple_id\")\n      private String tupleId;\n      @Column(name = \"create_time\")\n      private Timestamp createTime;\n      @Column(name = \"update_time\")\n      private Timestamp updateTime;\n\n      @PrePersist\n      public void beforeAdd() {\n          LocalDateTime ldt = LocalDateTime.ofInstant(Instant.now(), ZoneOffset.UTC);\n          this.createTime = Timestamp.valueOf(ldt);\n      }\n\n      @PreUpdate\n      public void beforeUpdate() {\n          LocalDateTime ldt = LocalDateTime.ofInstant(Instant.now(), ZoneOffset.UTC);\n          this.updateTime = Timestamp.valueOf(ldt);\n      }\n  }\n  ```\n\n1. `JOINED` : 각각의 테이블로 생성한 뒤 조인하는 전략\n  * implement code\n    ```java\n    @Entity\n    @Inheritance(strategy = InheritanceType.JOINED)\n    @DiscriminatorColumn(name=\"DTYPE\") //default가 DTYPE\n    public class BaseEntity {\n        @Id\n        @Column(name = \"tuple_id\")\n        private String tupleId;\n        @Column(name = \"create_time\")\n        private Timestamp createTime;\n        @Column(name = \"update_time\")\n        private Timestamp updateTime;\n\n        @PrePersist\n        ..\n    }\n    ```\n  * `base_item`, `app_a`, `app_b`, `app_c` 4개의 테이블이 관리되며 base_item 테이블에만 tuple_id, create_time, update_time 의 데이터가 저장된다. tuple_id 칼럼이 PK이자 FK가 된다.\n  * 필수로 선언해야 하는 `@DiscriminatorColumn`으로 생성된 `DTYPE` 칼럼은 `sub type` 테이블 중 어떤 곳에 데이터가 생성되었는지 명시하는 역할이며, default는 엔티티 클래스 이름이 사용된다 (`appA`, `appB`, `appC`)\n  * `app_a` 테이블에 신규 데이터를 저장하면 insert query가 두 번 실행되며, `app_a` 데이터를 생성 시간과 함께 조회하고자 하면 조인이 필요해진다.\n  * DB 관점에서 가장 정규화된 구조이며 메모리 측면에서도 잇점이 있다고 한다.\n2. `SINGLE_TABLE` : 통합 테이블로 변환하는 단일 테이블 전략\n  * implement code\n    ```java\n    @Entity\n    @Inheritance(strategy = InheritanceType.SINGLE_TABLE)\n    //@DiscriminatorColumn default DTYPE으로 칼럼 생성해줌\n    public class BaseEntity {\n        @Id\n        @Column(name = \"tuple_id\")\n        private String tupleId;\n        @Column(name = \"create_time\")\n        private Timestamp createTime;\n        @Column(name = \"update_time\")\n        private Timestamp updateTime;\n\n        @PrePersist\n        ...\n    }\n    ```\n  * 규모나 복잡도가 크지 않은 엔티티들의 경우 모든 엔티티의 칼럼을 한 테이블에 다 저장하고 `DTYPE`으로 구분할 수 있다.\n  * insert query도 한 번이고, 조인도 필요가 없다.\n  * 진행 중인 프로젝트에서는 appA~appC 에 대한 칼럼 변경이 빈번하게 일어나며 DB를 웹에서만 접근하는 구조가 아니기 때문에 한 테이블에 몰아두고 `DTYPE`으로 구분하여 사용하기에는 무리가 있다.\n3. **`TABLE_PER_CLASS` : 구현 클래스마다 테이블을 생성하는 전략**  \n  * implement code\n    ```java\n    @Entity\n    @Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)\n    public class BaseEntity {\n        @Id\n        @Column(name = \"tuple_id\")\n        private String tupleId;\n        @Column(name = \"create_time\")\n        private Timestamp createTime;\n        @Column(name = \"update_time\")\n        private Timestamp updateTime;\n\n        @PrePersist\n        ...\n    }\n    ```\n  * 1번 JOINED 전략과 유사해보이지만 `super type` 엔티티의 칼럼들을 `sub type`의 엔티티 모두에 동일하게 생성하여 `app_a`, `app_b`, `app_c` 총 3개의 테이블을 관리하게 된다.\n  * `super type` 엔티티로 접근할 경우 `app_a`~`app_c` 를 `UNION` 연산자를 사용하여 조회하기 때문에 이런 경우 성능이 좋다고 할 수는 없다.\n\n---\n\n## 어노테이션 등 설정값 정리\n**🌟 출처 : [victolee - [Spring JPA] 상속(JOINED 전략을 중심으로)](https://victorydntmd.tistory.com/209)**\n### 상속 관계 관련\n  * @Inheritance\n    * 어떤 상속 전략을 사용할 것인지 명시\n  * @DiscriminatorColumn\n    * `super type` 엔티티에서 어떤 칼럼을 사용하여 `sub type` 엔티티를 구분할 것인지 명시\n  * @DiscriminatorValue\n    * 위의 칼럼에서 `sub type` 엔티티 별로 값을 가지도록 지정\n    * DB에서 table column value로 들어갈 값이기 때문에 영어/한글 구분 없이 사용 가능\n### 객체 매핑 관련\n  * @MappedSuperclass\n    * 객체 지향적으로는 상속 관계를 유지하지만 실제 구현될 entity에는 영향을 주지 않기 위해서 사용\n    * `super type` 엔티티에서 `@Entity` 대신 `@MappedSuperclass`로 선언\n      * 실제로 구현 될 엔티티가 아니기 때문에 추상클래스로 선언\n      * `@ID` 로 선언해서 사용할 id 칼럼도 필요없음\n    * 위의 예제에서 `BaseEntity`에 이 어노테이션을 적용하면 `BaseEntity`에 대한 엔티티는 생성되지 않고, `TABLE_PER_CLASS` 전략을 적용한 것과 유사하게 `BaseEntity`에 있는 칼럼을 모두 자식 `sub type` 엔티티에 포함하여 생성\n  * @AttributeOverride / @AttributeOverrides\n    * `@MappedSuperclass`를 사용하는 경우, 부모 클래스의 특정 칼럼을 override하려고 할 때 사용\n    ```java\n    @MappedSuperclass\n    public abstract class BaseEntity{\n        @Column(name = \"create_time\")\n        private Timestamp createTime;\n        @Column(name = \"update_time\")\n        private Timestamp updateTime;\n    }\n\n    @Entity\n    @AttributeOverride(name=\"updateTime\", column=@Column(name=\"app_a_update_time\"))\n    public class AppA extends BaseEntity{\n      private String appAVar;\n    }\n\n    @Entity\n    @AttributeOverrides({\n      @AttributeOverride(name=\"createTime\", column=@Column(name=\"app_b_create_time\")),\n      @AttributeOverride(name=\"updateTime\", column=@Column(name=\"app_b_update_time\")),\n    })\n    public class AppB extends BaseEntity{\n      private String appBVar;\n    }\n    ```\n---\n\n### 결론\n* 원래 적용하려고 했던 내용은 `@MappedSuperclass`를 사용하여 적용하였음\n* 기존에 QueryDsl로 직접 조인하여 select 하도록 설계했던 부분을 JAVA code 상에서 명시적으로 상속 관계에 있음을 파악할 수 있도록 관련있는 엔티티들에 JOINED 전략을 적용하였음\n\n### 참조\n* Entity에서는 여러 변수에 @Id를 선언하여 복합키로써 사용할 수 있는데, 이 경우 @GeneratedValue를 사용할 수가 없다. 직접 할당만 가능  \n(출처 : [catpark's something new - jpa 복합키에서 auto increment](https://www.icatpark.com/entry/jpa-%EB%B3%B5%ED%95%A9%ED%82%A4%EC%97%90%EC%84%9C-auto-increment))\n","title":"JPA 상속관계 매핑 전략","date":"2022-10-28","category":["backend","spring"],"tag":["jpa","@inheritance","@MappedSuperclass"]},"prev":{"id":"20221020","title":"Ubuntu 명령어 정리","date":"2022-10-20","category":["os","linux"],"tag":["command"]},"next":{"id":"20221109","title":"Ubuntu 명령어 정리(2)","date":"2022-11-09","category":["os","linux"],"tag":["command"]},"nearPost":[{"id":"20230209","title":"[js] Default parameters of function \u0026 Spread syntax in object literals","date":"2023-02-09","category":["frontend","javascript"],"tag":["javascript","es5","default parameter","spread syntax"]},{"id":"20221114","title":"Github Action - AWS EC2에 SpringBoot 배포","date":"2022-11-14","category":["tool","git"],"tag":["git-action","Git","aws"]},{"id":"20221109","title":"Ubuntu 명령어 정리(2)","date":"2022-11-09","category":["os","linux"],"tag":["command"]},{"id":"20221020","title":"Ubuntu 명령어 정리","date":"2022-10-20","category":["os","linux"],"tag":["command"]},{"id":"20220816","title":"What happens when jdk compiles the generic type \u003cT\u003e","date":"2022-08-16","category":["backend","java"],"tag":["Generic","Type Erasure","ClassCastException"]}]},"__N_SSG":true},"page":"/blog/[postId]","query":{"postId":"20221028"},"buildId":"PHLxsgcNLF0x70eC5EpSo","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>